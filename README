This branch has been created before pushing the large code refactoring
to have the protocol logic in a dedicated module.

It is kept here for backup purpose.
